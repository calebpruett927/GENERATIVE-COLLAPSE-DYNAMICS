schema: "schemas/closures.schema.json"

closure:
  kind: "privacy_rules"
  id: "SECURITY.PRIVACY.rules.v1"

  privacy_rules:
    # Frozen privacy validation rules
    # Defines what constitutes a privacy violation

    pii_patterns:
      # Personally Identifiable Information detection
      ssn:
        pattern: "\\b\\d{3}-\\d{2}-\\d{4}\\b"
        severity: "critical"

      credit_card:
        pattern: "\\b(?:\\d{4}[- ]?){3}\\d{4}\\b"
        severity: "critical"
        luhn_validate: true

      email:
        pattern: "\\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Z|a-z]{2,}\\b"
        severity: "moderate"

      phone:
        pattern: "\\b(?:\\+?1[-.]?)?\\(?\\d{3}\\)?[-.]?\\d{3}[-.]?\\d{4}\\b"
        severity: "moderate"

      ip_address:
        pattern: "\\b(?:\\d{1,3}\\.){3}\\d{1,3}\\b"
        severity: "low"

    data_handling:
      # What should happen with detected PII
      log_exposure: true
      hash_before_storage: true
      require_encryption: true

    consent_requirements:
      # Consent tracking
      require_explicit: ["ssn", "credit_card"]
      require_implicit: ["email", "phone"]

    retention_limits:
      # Data retention rules
      pii_max_days: 365
      logs_max_days: 90

  scoring:
    # Privacy score weights (contribute to T)
    w_pii_exposure: 0.4
    w_encryption: 0.3
    w_consent: 0.2
    w_retention: 0.1

  notes: >
    Tier-0 closure defining frozen privacy validation rules.
    Privacy violations reduce Trust Fidelity (T) and increase Threat Drift (Î¸).

  extensions: {}
