# closures/registry.yaml
# Central closure registry for UMCP protocol
# Cross-references: manifest.yaml, contract.yaml, casepacks/*/closures/closure_registry.yaml
# Documentation: docs/interconnected_architecture.md, GLOSSARY.md#closure-registry
schema: "schemas/closures.schema.json"

registry:
  id: "UMCP.CLOSURES.DEFAULT.v1"
  notes: >
    Default closure registry with base closures and GCD/RCFT extensions.
    Version 1.0.0 - includes gamma, return-domain, norms, and curvature-neighborhood defaults.
  closures:
    gamma:
      path: "closures/gamma.default.v1.yaml"
    return_domain:
      path: "closures/return_domain.window64.v1.yaml"
    norms:
      path: "closures/norms.l2_eta1e-3.v1.yaml"
    curvature_neighborhood:
      path: "closures/curvature_neighborhood.default.v1.yaml"
  notes: >
    Default closure registry used by UMA.INTSTACK.v1.
    Includes gamma, return-domain, norms, and curvature-neighborhood defaults.
  extensions:
    gcd:
      - name: "energy_potential"
        path: "closures/gcd/energy_potential.py"
        description: "Energy potential computation: E = ω² + α·S + β·C²"
        inputs: ["omega", "S", "C"]
        outputs: ["E_potential", "E_collapse", "E_entropy", "E_curvature", "regime"]
      - name: "entropic_collapse"
        path: "closures/gcd/entropic_collapse.py"
        description: "Entropic collapse potential: Φ_collapse = S·(1-F)·exp(-τ_R/τ_0)"
        inputs: ["S", "F", "tau_R"]
        outputs: ["phi_collapse", "S_contribution", "F_contribution", "tau_damping", "regime"]
      - name: "generative_flux"
        path: "closures/gcd/generative_flux.py"
        description: "Generative flux: Φ_gen = κ·√IC·(1+C²)"
        inputs: ["kappa", "IC", "C"]
        outputs: ["phi_gen", "kappa_component", "IC_amplification", "curvature_modulation", "regime"]
      - name: "field_resonance"
        path: "closures/gcd/field_resonance.py"
        description: "Field resonance: R = (1-|ω|)·(1-S)·exp(-C/C_crit)"
        inputs: ["omega", "S", "C"]
        outputs: ["resonance", "coherence_factor", "order_factor", "curvature_damping", "regime"]
      - name: "momentum_flux"
        path: "closures/gcd/momentum_flux.py"
        description: "Momentum transfer flux: Φ_momentum = (dκ/dt)·√(1+C²)·(1-ω)"
        inputs: ["kappa_series", "C_series", "omega_series", "dt"]
        outputs: ["phi_momentum", "dkappa_dt", "mean_flux", "regime", "net_integrity_change", "flux_variance"]
    rcft:
      - name: "fractal_dimension"
        path: "closures/rcft/fractal_dimension.py"
        description: "Fractal dimension of collapse trajectory: D_f = log(N(ε))/log(1/ε)"
        inputs: ["trajectory", "eps_values"]
        outputs: ["D_fractal", "regime", "box_counts", "r_squared", "log_slope"]
      - name: "recursive_field"
        path: "closures/rcft/recursive_field.py"
        description: "Recursive field strength: Ψ_r = Σ α^n·Ψ_n"
        inputs: ["S_series", "C_series", "F_series", "alpha"]
        outputs: ["Psi_recursive", "regime", "contributions", "convergence_achieved"]
      - name: "resonance_pattern"
        path: "closures/rcft/resonance_pattern.py"
        description: "Resonance pattern analysis: λ_p, Θ via FFT"
        inputs: ["field_series", "dt"]
        outputs: ["lambda_pattern", "Theta_phase", "pattern_type", "phase_coherence"]
      - name: "attractor_basin"
        path: "closures/rcft/attractor_basin.py"
        description: "Attractor basin topology: B = -∇²Ψ_r / ||∇Ψ_r||"
        inputs: ["omega_series", "S_series", "C_series", "psi_r_series"]
        outputs: ["n_attractors_found", "attractor_locations", "basin_strengths", "regime", "convergence_rates", "basin_volumes"]
    optimizations:
      - name: "tau_R_optimized"
        path: "src/umcp/tau_R_optimized.py"
        description: "Optimized return time computation (OPT-7,8,9): Domain caching, Karp cycle detection, vectorized bounds"
        optimizations: ["OPT-7", "OPT-8", "OPT-9"]
        inputs: ["trajectory", "theta", "bounds"]
        outputs: ["tau_R", "cycle_info", "bounds"]
      - name: "kernel_optimized"
        path: "src/umcp/kernel_optimized.py"
        description: "Optimized kernel computations (OPT-1,2,3,4,12,14,15): Lemma-based bounds validation, vectorized invariants"
        optimizations: ["OPT-1", "OPT-2", "OPT-3", "OPT-4", "OPT-12", "OPT-14", "OPT-15"]
        inputs: ["kappa", "omega", "S", "C", "F", "IC"]
        outputs: ["validated", "invariants"]
      - name: "seam_optimized"
        path: "src/umcp/seam_optimized.py"
        description: "Optimized seam chain accumulation (OPT-10,11): ε-closure caching, incremental updates"
        optimizations: ["OPT-10", "OPT-11"]
        inputs: ["seam_chain", "epsilon"]
        outputs: ["accumulated_seam", "graph"]
      - name: "compute_utils"
        path: "src/umcp/compute_utils.py"
        description: "General computational utilities (OPT-17,20): Weight pruning, coordinate clipping, batch processing"
        optimizations: ["OPT-17", "OPT-20"]
        inputs: ["weights", "coordinates", "batch"]
        outputs: ["pruned", "clipped", "statistics"]
    kinematics:
      - name: "linear_kinematics"
        path: "closures/kinematics/linear_kinematics.py"
        description: "Linear kinematics: position, velocity, acceleration with predictions"
        contract: "KIN.INTSTACK.v1"
        inputs: ["x", "v", "a", "dt"]
        outputs: ["position", "velocity", "acceleration", "phase_magnitude", "phase_angle", "predicted_x_next", "predicted_v_next", "regime"]
      - name: "rotational_kinematics"
        path: "closures/kinematics/rotational_kinematics.py"
        description: "Rotational kinematics: angular position, velocity, acceleration, torque"
        contract: "KIN.INTSTACK.v1"
        inputs: ["theta", "omega_rot", "alpha", "I_normalized", "dt"]
        outputs: ["theta", "omega_rot", "alpha", "angular_momentum", "torque", "E_rotational", "regime"]
      - name: "energy_mechanics"
        path: "closures/kinematics/energy_mechanics.py"
        description: "Energy mechanics: kinetic, potential, mechanical energy, work, power"
        contract: "KIN.INTSTACK.v1"
        inputs: ["v", "h", "m_normalized", "F_net", "displacement"]
        outputs: ["E_kinetic", "E_potential", "E_mechanical", "W", "P_power", "regime"]
      - name: "momentum_dynamics"
        path: "closures/kinematics/momentum_dynamics.py"
        description: "Momentum dynamics: linear momentum, impulse, collisions, conservation"
        contract: "KIN.INTSTACK.v1"
        inputs: ["v", "m_normalized", "F_net", "dt"]
        outputs: ["p", "J", "collision_results", "momentum_conserved", "regime"]
      - name: "phase_space_return"
        path: "closures/kinematics/phase_space_return.py"
        description: "Phase space return: τ_kin computation in (x,v) space"
        contract: "KIN.INTSTACK.v1"
        inputs: ["x_series", "v_series", "eta_phase", "H_rec_kin"]
        outputs: ["tau_kin", "return_status", "return_rate", "dynamics_regime"]
      - name: "kinematic_stability"
        path: "closures/kinematics/kinematic_stability.py"
        description: "Kinematic stability: K_stability index, regime classification"
        contract: "KIN.INTSTACK.v1"
        inputs: ["x_series", "v_series", "a_series"]
        outputs: ["K_stability", "S_kin", "C_kin", "omega_kin", "regime", "motion_regime"]
