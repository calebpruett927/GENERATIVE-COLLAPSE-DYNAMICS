# yaml-language-server: $schema=../../../schemas/closures_registry.schema.json
---
# UMCP Security Closures Registry
# Format: closures_registry.schema.json
# Version: 1.0.0
schema: "schemas/closures_registry.schema.json"

registry:
  id: "UMCP.CLOSURES.SECURITY.v1"
  version: "1.0.0"
  description: "Security domain closures implementing UMCP validation for anti-virus, anti-scam, identity, and privacy."
  contract: "SECURITY.INTSTACK.v1"

  closures:
    gamma:
      id: "gamma.default.v1"
      description: "Drift cost barrier: Gamma(omega) = omega^3 / (1 - omega + epsilon)"
      formula: "Gamma(omega) = omega^3 / (1 - omega + epsilon)"
      path: "closures/gamma.default.v1.yaml"
      parameters:
        p: 3
        epsilon: 1.0e-8

    DC_form:
      id: "DC.alpha_scaling.v1"
      description: "Curvature cost: D_C = alpha * C"
      formula: "D_C = alpha * C"
      parameters:
        alpha: 1.0

    trust_fidelity:
      id: "trust_fidelity.v1"
      description: "Trust Fidelity (T) and Threat Drift (theta)"
      formula: "T = sum(w_i * s_i); theta = 1 - T"
      path: "closures/security/trust_fidelity.py"

    security_entropy:
      id: "security_entropy.v1"
      description: "Security Entropy (H) and Signal Dispersion (D)"
      formula: "H = -sum(w_i * [s_i*ln(s_i) + (1-s_i)*ln(1-s_i)]); D = std(s_i)/0.5"
      path: "closures/security/security_entropy.py"

    trust_integrity:
      id: "trust_integrity.v1"
      description: "Log-Integrity (sigma) and Trust IC (TIC)"
      formula: "sigma = sum(w_i * ln(s_i + epsilon)); TIC = exp(sigma)"
      path: "closures/security/trust_integrity.py"

    anomaly_return:
      id: "anomaly_return.v1"
      description: "Anomaly Return Time (tau_A)"
      formula: "tau_A = min{t-u : ||S(t)-S(u)|| <= eta}"
      path: "closures/security/anomaly_return.py"

  security_closures:
    threat_classifier:
      id: "threat_classifier.v1"
      path: "closures/security/threat_classifier.py"
      description: "Classifies threats by type"

    reputation_analyzer:
      id: "reputation_analyzer.v1"
      path: "closures/security/reputation_analyzer.py"
      description: "Analyzes URL, file, IP reputation"

    behavior_profiler:
      id: "behavior_profiler.v1"
      path: "closures/security/behavior_profiler.py"
      description: "Detects behavioral anomalies"

    privacy_auditor:
      id: "privacy_auditor.v1"
      path: "closures/security/privacy_auditor.py"
      description: "Detects PII and privacy violations"

  weld_budget:
    enabled: false
    formula: "delta_kappa = R*tau_R - (D_omega + D_C)"
    note: "Budget terms declared for completeness"
    components:
      - "R*tau_R: return credit term"
      - "D_omega: omega dissipation"
      - "D_C: curvature dissipation"

  notes: "Security domain closures translating 'What Returns Through Collapse Is Real' to security validation."
